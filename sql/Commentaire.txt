
Ma data connection string ne pas supprimer
this->sCnx = "Data Source=DESKTOP-B8TDUS7\\SQLSERVER;Integrated Security=True;Connect Timeout=30;Encrypt=False;TrustServerCertificate=False;ApplicationIntent=ReadWrite;MultiSubnetFailover=False";





// Onglet Client 

   // LOAD
	private: System::Void button2_Click(System::Object^ sender, System::EventArgs^ e) {
		this->Refresh();
		this->oDs = this->oSvc->select_tout_nos_client("Rsl");
		this->dgv_enr->DataSource = this->oDs;
		this->dgv_enr->DataMember = "Rsl";

	}
		   // UPD      this->oSvc->ajouterUnePersonne(this->txt_nom->Text, this->txt_prenom->Text);
	private: System::Void button4_Click(System::Object^ sender, System::EventArgs^ e) {


	}
		   // INS
	private: System::Void button3_Click(System::Object^ sender, System::EventArgs^ e) {
		this->oSvc->ins_un_client(this->textBox1->Text, this->textBox2->Text, this->textBox3->Text);
	}

		   // DEL
	private: System::Void button5_Click(System::Object^ sender, System::EventArgs^ e) {

	}





// Microsoft SQL Server Data structure + data/*------------------------------------------------------------
*        Script SQLSERVER 
------------------------------------------------------------*/


/*------------------------------------------------------------
-- Table: Client
------------------------------------------------------------*/
CREATE TABLE Client(
	numeroClient    INT IDENTITY (1,1) NOT NULL ,
	Nom             CHAR (20)  NOT NULL ,
	Prenom          CHAR (20)  NOT NULL ,
	DateNaissance   DATE NOT NULL  ,
	CONSTRAINT Client_PK PRIMARY KEY (numeroClient)
);


/*------------------------------------------------------------
-- Table: Commande
------------------------------------------------------------*/
CREATE TABLE Commande(
	RefCommande     VARCHAR (20) NOT NULL ,
	DateLivraison   DATE NOT NULL ,
	DateEmission    DATE NOT NULL ,
	numeroClient    INT  NOT NULL  ,
	CONSTRAINT Commande_PK PRIMARY KEY (RefCommande)
);


/*------------------------------------------------------------
-- Table: Ville
------------------------------------------------------------*/
CREATE TABLE Ville(
	IDVille    INT IDENTITY (1,1) NOT NULL ,
	NomVille   CHAR (20)  NOT NULL  ,
	CONSTRAINT Ville_PK PRIMARY KEY (IDVille)
);


/*------------------------------------------------------------
-- Table: Adresse
------------------------------------------------------------*/
CREATE TABLE Adresse(
	IDAdresse   INT IDENTITY (1,1) NOT NULL ,
	Numero      INT  NOT NULL ,
	Rue         CHAR (20)  NOT NULL ,
	IDVille     INT  NOT NULL  ,
	CONSTRAINT Adresse_PK PRIMARY KEY (IDAdresse)
);


/*------------------------------------------------------------
-- Table: ModePaiement
------------------------------------------------------------*/
CREATE TABLE ModePaiement(
	IDMoyenPaiement   INT IDENTITY (1,1) NOT NULL ,
	MoyenPaiement     CHAR (20)  NOT NULL  ,
	CONSTRAINT ModePaiement_PK PRIMARY KEY (IDMoyenPaiement)
);


/*------------------------------------------------------------
-- Table: Article
------------------------------------------------------------*/
CREATE TABLE Article(
	Reference                  INT IDENTITY (1,1) NOT NULL ,
	Nom                        CHAR (20)  NOT NULL ,
	QuantiteStock              INT  NOT NULL ,
	PrixProduit                INT  NOT NULL ,
	SeuilReapprovisionnement   INT  NOT NULL  ,
	CONSTRAINT Article_PK PRIMARY KEY (Reference)
);


/*------------------------------------------------------------
-- Table: Taxe
------------------------------------------------------------*/
CREATE TABLE Taxe(
	IDTaxe            INT IDENTITY (1,1) NOT NULL ,
	NomTaxe           CHAR (20)  NOT NULL ,
	PourcentageTaxe   FLOAT  NOT NULL  ,
	CONSTRAINT Taxe_PK PRIMARY KEY (IDTaxe)
);


/*------------------------------------------------------------
-- Table: Paiement
------------------------------------------------------------*/
CREATE TABLE Paiement(
	IDPaiement        INT IDENTITY (1,1) NOT NULL ,
	DatePaiement      DATE NOT NULL ,
	montantPaiement   INT  NOT NULL ,
	RefCommande       VARCHAR (20) NOT NULL ,
	IDMoyenPaiement   INT  NOT NULL  ,
	CONSTRAINT Paiement_PK PRIMARY KEY (IDPaiement)
);


/*------------------------------------------------------------
-- Table: Remise
------------------------------------------------------------*/
CREATE TABLE Remise(
	idremise            INT IDENTITY (1,1) NOT NULL ,
	Nomremise           CHAR (20)  NOT NULL ,
	pourcentageRemise   FLOAT  NOT NULL  ,
	CONSTRAINT Remise_PK PRIMARY KEY (idremise)
);


/*------------------------------------------------------------
-- Table: Composer
------------------------------------------------------------*/
CREATE TABLE Composer(
	Reference        INT  NOT NULL ,
	RefCommande      VARCHAR (20) NOT NULL ,
	nombreArticle    INT  NOT NULL ,
	PrixUHT          INT  NOT NULL ,
	pourcentageTVA   FLOAT  NOT NULL ,
	Couleur          CHAR (20)  NOT NULL  ,
	CONSTRAINT Composer_PK PRIMARY KEY (Reference,RefCommande)
);


/*------------------------------------------------------------
-- Table: Posseder
------------------------------------------------------------*/
CREATE TABLE Posseder(
	numeroClient   INT  NOT NULL ,
	IDAdresse      INT  NOT NULL ,
	TypeAdresse    CHAR (20)  NOT NULL  ,
	CONSTRAINT Posseder_PK PRIMARY KEY (numeroClient,IDAdresse)
);


/*------------------------------------------------------------
-- Table: Taxer
------------------------------------------------------------*/
CREATE TABLE Taxer(
	IDTaxe      INT  NOT NULL ,
	Reference   INT  NOT NULL  ,
	CONSTRAINT Taxer_PK PRIMARY KEY (IDTaxe,Reference)
);


/*------------------------------------------------------------
-- Table: Beneficier
------------------------------------------------------------*/
CREATE TABLE Beneficier(
	idremise      INT  NOT NULL ,
	RefCommande   VARCHAR (20) NOT NULL  ,
	CONSTRAINT Beneficier_PK PRIMARY KEY (idremise,RefCommande)
);


/*------------------------------------------------------------
-- Table: Employé
------------------------------------------------------------*/
CREATE TABLE Employe(
	IDEmploye           INT IDENTITY (1,1) NOT NULL ,
	Nom                 CHAR (10)  NOT NULL ,
	Prenom              CHAR (20)  NOT NULL ,
	DateEmbauche        DATE NOT NULL ,
	IDAdresse           INT  NOT NULL ,
	IDEmploye_Employe   INT    ,
	CONSTRAINT Employe_PK PRIMARY KEY (IDEmploye)
);




ALTER TABLE Commande
	ADD CONSTRAINT Commande_Client0_FK
	FOREIGN KEY (numeroClient)
	REFERENCES Client(numeroClient);

ALTER TABLE Adresse
	ADD CONSTRAINT Adresse_Ville0_FK
	FOREIGN KEY (IDVille)
	REFERENCES Ville(IDVille);

ALTER TABLE Paiement
	ADD CONSTRAINT Paiement_Commande0_FK
	FOREIGN KEY (RefCommande)
	REFERENCES Commande(RefCommande);

ALTER TABLE Paiement
	ADD CONSTRAINT Paiement_ModePaiement1_FK
	FOREIGN KEY (IDMoyenPaiement)
	REFERENCES ModePaiement(IDMoyenPaiement);

ALTER TABLE Composer
	ADD CONSTRAINT Composer_Article0_FK
	FOREIGN KEY (Reference)
	REFERENCES Article(Reference);

ALTER TABLE Composer
	ADD CONSTRAINT Composer_Commande1_FK
	FOREIGN KEY (RefCommande)
	REFERENCES Commande(RefCommande);

ALTER TABLE Posseder
	ADD CONSTRAINT Posseder_Client0_FK
	FOREIGN KEY (numeroClient)
	REFERENCES Client(numeroClient);

ALTER TABLE Posseder
	ADD CONSTRAINT Posseder_Adresse1_FK
	FOREIGN KEY (IDAdresse)
	REFERENCES Adresse(IDAdresse);

ALTER TABLE Taxer
	ADD CONSTRAINT Taxer_Taxe0_FK
	FOREIGN KEY (IDTaxe)
	REFERENCES Taxe(IDTaxe);

ALTER TABLE Taxer
	ADD CONSTRAINT Taxer_Article1_FK
	FOREIGN KEY (Reference)
	REFERENCES Article(Reference);

ALTER TABLE Beneficier
	ADD CONSTRAINT Beneficier_Remise0_FK
	FOREIGN KEY (idremise)
	REFERENCES Remise(idremise);

ALTER TABLE Beneficier
	ADD CONSTRAINT Beneficier_Commande1_FK
	FOREIGN KEY (RefCommande)
	REFERENCES Commande(RefCommande);

ALTER TABLE Employe
	ADD CONSTRAINT Employe_Adresse0_FK
	FOREIGN KEY (IDAdresse)
	REFERENCES Adresse(IDAdresse);

ALTER TABLE Employe
	ADD CONSTRAINT Employe_Employe1_FK
	FOREIGN KEY (IDEmploye_Employe)
	REFERENCES Employe(IDEmploye);


	  





























INSERT INTO Taxe(NomTaxe, Pourcentagetaxe) VALUES('TVA1',20)
INSERT INTO Taxe(NomTaxe, Pourcentagetaxe) VALUES('TVA2',10)
INSERT INTO Taxe(NomTaxe, Pourcentagetaxe) VALUES('TVA3',5.5)

INSERT INTO Composer(Reference , RefCommande, nombreArticle, PrixUHT, pourcentageTVA, Couleur) VALUES(3,'1',3,2,0.2,'Vert')
INSERT INTO Composer(Reference , RefCommande, nombreArticle, PrixUHT, pourcentageTVA, Couleur) VALUES(4,'2',10,2,0.2,'Rouge')
INSERT INTO Composer(Reference , RefCommande, nombreArticle, PrixUHT, pourcentageTVA, Couleur) VALUES(7,'3',28,1,0.3,'Bleu')
INSERT INTO Composer(Reference , RefCommande, nombreArticle, PrixUHT, pourcentageTVA, Couleur) VALUES(3,'4',4,15,0.4,'Jaune')
INSERT INTO Composer(Reference , RefCommande, nombreArticle, PrixUHT, pourcentageTVA, Couleur) VALUES(5,'5',65,8,0.5,'Violet')
INSERT INTO Composer(Reference , RefCommande, nombreArticle, PrixUHT, pourcentageTVA, Couleur) VALUES(6,'6',30,10,0.6,'Orange')
INSERT INTO Composer(Reference , RefCommande, nombreArticle, PrixUHT, pourcentageTVA, Couleur) VALUES(3,'7',10,3,0.7,'Marron')

INSERT INTO Taxer(IDTAXE, Reference) VALUES(2, 1)
INSERT INTO Taxer(IDTAXE, Reference) VALUES(3, 2)
INSERT INTO Taxer(IDTAXE, Reference) VALUES(2, 3)
INSERT INTO Taxer(IDTAXE, Reference) VALUES(2, 4)
INSERT INTO Taxer(IDTAXE, Reference) VALUES(2, 5)
INSERT INTO Taxer(IDTAXE, Reference) VALUES(2, 6)
INSERT INTO Taxer(IDTAXE, Reference) VALUES(2, 7)
INSERT INTO Taxer(IDTAXE, Reference) VALUES(3, 8)


